% Impulse response for inelastic labor supply model 
% Econ 210C HW2
% Minki Kim

clear;
clc;

% Setting parameters
alpha = 0.33;
delta = 0.076;
betaa = 0.99;
rho = 0.95;
sigma_epsilon = 0.01; % To set std of TFP close to 2.29

y_k = (1/alpha)*(1/betaa + delta - 1);
k_y = 1/y_k;
c_k = y_k - delta;
k_c = 1/c_k;
y_c = y_k/c_k;
c_y = 1/y_c;
i_y = delta*k_y;

gamma = 1/betaa + 1 - c_k*(1 - betaa*(1-delta))*(alpha - 1);
nu_kk = (gamma - sqrt(gamma^2 - 4/betaa))/2;
nu_kz = (y_c * (1-rho) + (1- betaa*(1-delta))*rho) / (k_c*(1-rho) + k_c*((1/betaa) - nu_kk) - ( 1 - betaa*(1-delta))*(alpha-1))   ;

nu_ck = k_c*(1/betaa - nu_kk);
nu_cz = y_c - k_c*nu_kz;

% Simluating the model 
simul_length = 1000;

epsilon_simul = normrnd(0,sigma_epsilon,[simul_length,1]);
z_simul = zeros(simul_length,1);
k_simul = zeros(simul_length,1);
c_simul = zeros(simul_length,1);
i_simul = zeros(simul_length,1);
y_simul = zeros(simul_length,1);

for i = 2:1000
    z_simul(i) = rho*z_simul(i-1) + epsilon_simul(i);
    k_simul(i) = nu_kk*k_simul(i-1) + nu_kz*z_simul(i);
    c_simul(i) = nu_ck*k_simul(i-1) + nu_cz*z_simul(i);
    i_simul(i) = k_simul(i)/delta - ((1-delta)/delta)*k_simul(i-1);
    y_simul(i) = c_y*c_simul(i) + i_y*i_simul(i);
end

FigHandle = figure('Position', [250, 300, 1200, 400]); set(0,'defaultlinelinewidth',1.3);
plot(k_simul(400:500)); hold on; plot(c_simul(400:500)); hold on; plot(i_simul(400:500)); hold on; plot(y_simul(400:500));
ylabel('Simulated values','FontSize',13); xlabel('time','FontSize',13); legend('Capital','Consumption','Investment','Output','Location','southeast'); xlim([0 100]); grid on;

disp(['Standard deviation of o is ', num2str(std(y_simul))]);
disp(['Standard deviation of output is ', num2str(std(y_simul))]);
disp(['Standard deviation of consumption is ', num2str(std(c_simul))]);
disp(['Standard deviation of investment is ', num2str(std(i_simul))]);

% Impulse response 
z_path = zeros(40,1);
c_path = zeros(40,1);
i_path = zeros(40,1);
y_path = zeros(40,1);
w_path = zeros(40,1);
